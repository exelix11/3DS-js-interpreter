Bridge.assembly("CS43D",function(){"use strict";Bridge.define("CS43D.App",{main:function(){for(CS43D.App.shoot=Lib3DS.Lib3DS.SoundLoadWave(CS43D.App.MakeRelativePath("sh.wav")),CS43D.App.explosion=Lib3DS.Lib3DS.SoundLoadWave(CS43D.App.MakeRelativePath("expl.wav")),CS43D.App.gpu=Lib3DS.Lib3DS.GetJsGpu(),Lib3DS.Lib3DS.clearConsole(),Lib3DS.Lib3DS.print("HELLO FROM C# "),Lib3DS.Lib3DS.print("Now watch this"),Lib3DS.Lib3DS.BottomScreenDisableConsole(),CS43D.App.textures[0]=CS43D.App.gpu.load_texture_png(CS43D.App.MakeRelativePath("alien.png")),CS43D.App.textures[1]=CS43D.App.gpu.load_texture_png(CS43D.App.MakeRelativePath("alien1.png")),CS43D.App.InitGame();Lib3DS.Lib3DS.aptMainLoop();)if(Lib3DS.Lib3DS.hidScanInput(),CS43D.App.KeyDown=Lib3DS.Lib3DS.hidKeysDown(),CS43D.App.keyHeld=Lib3DS.Lib3DS.hidKeysHeld(),CS43D.App.gpu.begin_draw(0,0),CS43D.App.InGame?CS43D.App.GameLoop():CS43D.App.MainMenu(),CS43D.App.gpu.draw_on(Lib3DS.Lib3DS.GFX_BOTTOM,0),CS43D.App.InGame&&CS43D.App.gpu.draw_text_center(1,0,1,1,4294967295,"Points: "+CS43D.App.DefeatedEnemies+"00"),CS43D.App.gpu.draw_text_center(1,64,1,1,4294967295,"#CSharp"),CS43D.App.gpu.end_draw(),Lib3DS.Lib3DS.gspWaitForVBlank(),CS43D.App.Key(CS43D.App.KeyDown,Lib3DS.KEY.START))break},statics:{fields:{textures:null,gpu:null,DefeatedEnemies:0,Objects:null,player:null,LastSpawnedX:0,EnAltSpr:!1,KeyDown:0,keyHeld:0,InGame:!1,shoot:null,explosion:null,EnemyMoveSpeed:0,FrameEnemyShoot:0,projCoolDown:0,UseAltSpr:!1,AltSprCounter:0},ctors:{init:function(){this.textures=System.Array.init(2,0,System.UInt32);this.DefeatedEnemies=0;this.Objects=System.Array.init(0,null,CS43D.App.GameObj);this.EnAltSpr=!1;this.KeyDown=0;this.keyHeld=0;this.InGame=!1;this.EnemyMoveSpeed=1;this.FrameEnemyShoot=16;this.projCoolDown=16;this.UseAltSpr=!1;this.AltSprCounter=0}},methods:{InitGame:function(){var $t,x;for(CS43D.App.DefeatedEnemies=0,CS43D.App.Objects=System.Array.init(0,null,CS43D.App.GameObj),CS43D.App.player=($t=new CS43D.App.Player,$t.x=184,$t.y=223,$t.w=32,$t.h=16,$t.alive=!0,$t),CS43D.App.Objects.push(CS43D.App.player),x=-32;x<Lib3DS.Lib3DS.TOP_WIDTH;)CS43D.App.Objects.push(($t=new CS43D.App.Enemy,$t.x=x,$t.y=10,$t.w=32,$t.h=16,$t.alive=!0,$t.altSpr=CS43D.App.EnAltSpr,$t)),CS43D.App.EnAltSpr=!CS43D.App.EnAltSpr,x+=48;CS43D.App.LastSpawnedX=-32;CS43D.App.Objects.push(($t=new CS43D.App.Barrier,$t.x=32,$t.y=176,$t.w=64,$t.h=16,$t.alive=!0,$t));CS43D.App.Objects.push(($t=new CS43D.App.Barrier,$t.x=160,$t.y=176,$t.w=64,$t.h=16,$t.alive=!0,$t));CS43D.App.Objects.push(($t=new CS43D.App.Barrier,$t.x=288,$t.y=176,$t.w=64,$t.h=16,$t.alive=!0,$t));CS43D.App.InGame=!0},MakeRelativePath:function(filename){return(Lib3DS.Lib3DS.ScriptRes()||"")+"/"+(filename||"")},MainMenu:function(){CS43D.App.gpu.draw_text_center(0,120,1,1,4294967295,"Press A");CS43D.App.Key(CS43D.App.KeyDown,Lib3DS.KEY.A)&&CS43D.App.InitGame()},GameLoop:function(){var $t,i;if(!CS43D.App.player.alive){CS43D.App.gpu.draw_text_center(0,120,1,1,4278190335,"You lost");CS43D.App.Key(CS43D.App.KeyDown,Lib3DS.KEY.A)&&(CS43D.App.InGame=!1);return}for(CS43D.App.EnemyMoveSpeed=1+(CS43D.App.DefeatedEnemies>>2),CS43D.App.EnemyMoveSpeed>5&&(CS43D.App.EnemyMoveSpeed=5),CS43D.App.LastSpawnedX+=CS43D.App.EnemyMoveSpeed,++CS43D.App.FrameEnemyShoot,++CS43D.App.projCoolDown,++CS43D.App.AltSprCounter,CS43D.App.AltSprCounter>30&&(CS43D.App.AltSprCounter=0,CS43D.App.UseAltSpr=!CS43D.App.UseAltSpr),CS43D.App.LastSpawnedX>=0&&(CS43D.App.LastSpawnedX=-48,CS43D.App.Objects.push(($t=new CS43D.App.Enemy,$t.x=CS43D.App.LastSpawnedX,$t.y=10,$t.w=32,$t.h=16,$t.alive=!0,$t.altSpr=CS43D.App.EnAltSpr,$t)),CS43D.App.EnAltSpr=!CS43D.App.EnAltSpr),i=0;i<CS43D.App.Objects.length;i++){if(CS43D.App.Objects[i].Frame(),!CS43D.App.Objects[i].alive){CS43D.App.Objects.splice(i,1);--i;continue}CS43D.App.Objects[i].Draw()}CS43D.App.Key(CS43D.App.KeyDown,Lib3DS.KEY.B)&&(Lib3DS.Lib3DS.clearConsole(),Lib3DS.Lib3DS.print(Bridge.toString(CS43D.App.Objects)))},Key:function(state,k){return(state&k)!=0},Rand:function(percent){return Math.random()<=percent},RandomInt:function(max){return Math.random()*(max+1)}}}});Bridge.define("CS43D.App.GameObj",{$kind:"nested class",fields:{x:0,y:0,w:0,h:0,alive:!1},methods:{collide:function(o){return!(this.x>o.x+o.w-1||this.y>o.y+o.h-1||o.x>this.x+this.w-1||o.y>this.y+this.h-1)},Draw:function(){},Frame:function(){},CheckProjHit:function(){},toString:function(){return"[GenericObj]"}}});Bridge.define("Lib3DS.GPU_FLIP_TYPE",{$kind:"enum",statics:{fields:{GPU_FLIP_VERTICAL:1,GPU_FLIP_HORIZONTAL:2,GPU_FLIP_BOTH:3}},$utype:System.Byte});Bridge.define("Lib3DS.KEY",{$kind:"enum",statics:{fields:{A:1,B:2,SELECT:4,START:8,DRIGHT:16,DLEFT:32,DUP:64,DDOWN:128,R:256,L:512,X:1024,Y:2048,ZL:16384,ZR:32768,TOUCH:1048576,CSTICK_RIGHT:16777216,CSTICK_LEFT:33554432,CSTICK_UP:67108864,CSTICK_DOWN:134217728,CPAD_RIGHT:268435456,CPAD_LEFT:536870912,CPAD_UP:1073741824,CPAD_DOWN:-2147483648,UP:1073741888,DOWN:-2147483520,LEFT:536870944,RIGHT:268435472}}});Bridge.define("Lib3DS.Lib3DS",{statics:{fields:{TOP_WIDTH:0,BOTTOM_WIDTH:0,SCREEN_HEIGHT:0,GFX_TOP:0,GFX_BOTTOM:0,GFX_LEFT:0,GFX_RIGHT:0},ctors:{init:function(){this.TOP_WIDTH=400;this.BOTTOM_WIDTH=320;this.SCREEN_HEIGHT=240;this.GFX_TOP=0;this.GFX_BOTTOM=1;this.GFX_LEFT=0;this.GFX_RIGHT=1}},methods:{RunFile:function(file){RunFile(file)},print:function(str){print(str)},clearConsole:function(){clearConsole()},ScriptPath:function(){return ScriptPath()},ScriptRes:function(){return ScriptRes()},aptMainLoop:function(){return aptMainLoop()},svcSleepThread:function(time){svcSleepThread(time)},hidScanInput:function(){hidScanInput()},hidKeysHeld:function(){return hidKeysHeld()},hidKeysDown:function(){return hidKeysDown()},gfxFlushBuffers:function(){gfxFlushBuffers()},gfxSwapBuffers:function(){gfxSwapBuffers()},gspWaitForVBlank:function(){gspWaitForVBlank()},osGetTime:function(){return osGetTime()},BottomScreenEnableConsole:function(){BottomScreenEnableConsole()},BottomScreenDisableConsole:function(){BottomScreenDisableConsole()},GetTouchScreen:function(){return GetTouchScreen()},GetGfxLib:function(){return GetGfxLib()},GetJsGpu:function(){return GetJsGpu()},SoundLoadWave:function(path){return SoundLoadWave(path)},SoundStopChannel:function(chn){SoundStopChannel(chn)},SoundStopAllChannels:function(){SoundStopAllChannels()},SoundFreeWave:function(f){SoundFreeWave(f)},SoundFreeAll:function(){SoundFreeAll()}}}});Bridge.define("CS43D.App.Barrier",{inherits:[CS43D.App.GameObj],$kind:"nested class",methods:{Draw:function(){CS43D.App.gpu.draw_rectangle(this.x,this.y,this.w,this.h,4294967295)},CheckProjHit:function(proj){if(this.alive&&this.collide(proj)){proj.alive=!1;this.w-=16;this.x+=8;this.w<=0&&(this.alive=!1);return}},toString:function(){return"[Barrier]"}}});Bridge.define("CS43D.App.Enemy",{inherits:[CS43D.App.GameObj],$kind:"nested class",fields:{altSpr:!1},ctors:{init:function(){this.altSpr=!1}},methods:{Draw:function(){this.x<-32||this.x>Lib3DS.Lib3DS.TOP_WIDTH||(this.altSpr===CS43D.App.UseAltSpr?CS43D.App.gpu.draw_texture(CS43D.App.textures[0],this.x,this.y):CS43D.App.gpu.draw_texture(CS43D.App.textures[1],this.x,this.y))},CheckProjHit:function(proj){if(this.alive&&!(this.x<32)&&this.collide(proj)){CS43D.App.explosion.Play(!1);++CS43D.App.DefeatedEnemies;proj.alive=!1;this.alive=!1;return}},Frame:function(){var $t;this.x+=CS43D.App.EnemyMoveSpeed;this.x>Lib3DS.Lib3DS.TOP_WIDTH&&(this.x=-32,this.y+=24,this.y>=CS43D.App.player.y&&(CS43D.App.player.alive=!1));CS43D.App.FrameEnemyShoot>30&&this.x>0&&CS43D.App.Rand(.006)&&(CS43D.App.Objects.push(($t=new CS43D.App.Proj,$t.x=this.x+(this.w>>1)-4,$t.y=this.y,$t.w=8,$t.h=8,$t.alive=!0,$t.speed=10,$t.hitType=CS43D.App.Player,$t)),CS43D.App.FrameEnemyShoot=0)},toString:function(){return"[Enemy]"}}});Bridge.define("CS43D.App.Player",{inherits:[CS43D.App.GameObj],$kind:"nested class",methods:{Draw:function(){CS43D.App.gpu.draw_rectangle(this.x,this.y,this.w,this.h,4294967295)},Frame:function(){var $t;CS43D.App.Key(CS43D.App.keyHeld,Lib3DS.KEY.LEFT)?this.x>=4?this.x-=4:this.x=0:CS43D.App.Key(CS43D.App.keyHeld,Lib3DS.KEY.RIGHT)&&(this.x<396-this.w?this.x+=4:this.x=Lib3DS.Lib3DS.TOP_WIDTH-this.w);CS43D.App.Key(CS43D.App.KeyDown,Lib3DS.KEY.A)&&CS43D.App.projCoolDown>8&&(CS43D.App.projCoolDown=0,CS43D.App.shoot.Play(!1),CS43D.App.Objects.push(($t=new CS43D.App.Proj,$t.x=this.x+(this.w>>1)-4,$t.y=this.y,$t.w=8,$t.h=8,$t.alive=!0,$t.speed=-10,$t.hitType=CS43D.App.Enemy,$t)))},CheckProjHit:function(proj){this.collide(proj)&&(this.alive=!1)},toString:function(){return"[Player]"}}});Bridge.define("CS43D.App.Proj",{inherits:[CS43D.App.GameObj],$kind:"nested class",fields:{speed:0,hitType:null},methods:{Draw:function(){CS43D.App.gpu.draw_rectangle(this.x,this.y,this.w,this.h,4294967295)},Frame:function(){var i,otherType;if(this.y+=this.speed,this.y<-8||this.y>Lib3DS.Lib3DS.SCREEN_HEIGHT){this.alive=!1;return}for(i=0;i<CS43D.App.Objects.length;i++)if((otherType=Bridge.getType(CS43D.App.Objects[i]),Bridge.referenceEquals(otherType,this.hitType)||Bridge.referenceEquals(otherType,CS43D.App.Barrier))&&(CS43D.App.Objects[i].CheckProjHit(this),!this.alive))break},toString:function(){return"[Proj]"}}})});